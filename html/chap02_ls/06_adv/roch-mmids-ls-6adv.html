

<!DOCTYPE html>


<html data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2.6. Advanced material &#8212; MMiDS Online Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap02_ls/06_adv/roch-mmids-ls-6adv';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="2.5. QR decomposition and Householder transformations" href="../05_qr/roch-mmids-ls-5qr.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/mmids-cover.png" class="logo__image only-light" alt="MMiDS Online Book - Home"/>
    <script>document.write(`<img src="../../_static/mmids-cover.png" class="logo__image only-dark" alt="MMiDS Online Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MMiDS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap01_intro/00_intro/roch-mmids-intro-0intro.html">1. Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap01_intro/01_motiv/roch-mmids-intro-1motiv.html">1.1. Motivating example: species delimitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01_intro/02_review/roch-mmids-intro-2review.html">1.2. Background: review of basic linear algebra, calculus, and probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01_intro/03_clustering/roch-mmids-intro-3clustering.html">1.3. Clustering: an objective, an algorithm and a guarantee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01_intro/04_highdim/roch-mmids-intro-4highdim.html">1.4. Some observations about high-dimensional data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01_intro/05_adv/roch-mmids-intro-5adv.html">1.5. Advanced material</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../00_intro/roch-mmids-ls-intro.html">2. Least squares</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../01_motiv/roch-mmids-ls-1motiv.html">2.1. Motivating example: predicting sales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_subspaces/roch-mmids-ls-2spaces.html">2.2. Background: linear spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_orthog/roch-mmids-ls-3orthog.html">2.3. A key concept: orthogonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_overdetermined/roch-mmids-ls-4overdetermined.html">2.4. Overdetermined linear systems and regression analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_qr/roch-mmids-ls-5qr.html">2.5. QR decomposition and Householder transformations</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.6. Advanced material</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Advanced material</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-dependence-lemma-and-its-implications">2.6.1. Linear Dependence Lemma and its implications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-cholesky-decomposition-theorem">2.6.2. Proof of Cholesky decomposition theorem</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="math notranslate nohighlight">
\[
\newcommand{\bfbeta}{\boldsymbol{\beta}}
\newcommand{\bflambda}{\boldsymbol{\lambda}}
\]</div>
<section id="advanced-material">
<h1><span class="section-number">2.6. </span>Advanced material<a class="headerlink" href="#advanced-material" title="Permalink to this headline">#</a></h1>
<p>In this section, we cover a few more advanced details. In particular, we prove the <em>Linear Dependence Lemma</em> and <em>Dimension Theorem</em>. We also prove the <em>Cholesky Decomposition Theorem</em>.</p>
<section id="linear-dependence-lemma-and-its-implications">
<h2><span class="section-number">2.6.1. </span>Linear Dependence Lemma and its implications<a class="headerlink" href="#linear-dependence-lemma-and-its-implications" title="Permalink to this headline">#</a></h2>
<p>In this section, we give a proof of the <em>Dimension Theorem</em>.</p>
<p>The proof relies on a fundamental lemma. It states that we can always remove a vector from a list of linearly dependent ones without changing its span.</p>
<p><strong>LEMMA</strong> <strong>(Linear Dependence)</strong> Let <span class="math notranslate nohighlight">\(\mathbf{u}_1,\ldots,\mathbf{u}_m\)</span> be a list of linearly dependent vectors with <span class="math notranslate nohighlight">\(\mathbf{u}_1 \neq 0\)</span>. Then there is an <span class="math notranslate nohighlight">\(i\)</span> such that:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}_i \in \mathrm{span}(\mathbf{u}_1,\ldots,\mathbf{u}_{i-1})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathrm{span}(\{\mathbf{u}_j:j \in [m]\}) = \mathrm{span}(\{\mathbf{u}_j:j \in [m],\  j\neq i\})\)</span></p></li>
</ol>
<p><span class="math notranslate nohighlight">\(\flat\)</span></p>
<p><em>Proof idea (Linear Dependence):</em> By linear dependence, <span class="math notranslate nohighlight">\(\mathbf{0}\)</span> can be written as a non-trivial linear combination of the <span class="math notranslate nohighlight">\(\mathbf{u}_j\)</span>’s. Then the index <span class="math notranslate nohighlight">\(i\)</span> in 1. is the largest index with non-zero coefficient.</p>
<p><em>Proof:</em> <em>(Linear Dependence)</em> For 1., by linear dependence,</p>
<div class="math notranslate nohighlight">
\[
\sum_{j=1}^m \alpha_j \mathbf{u}_j = \mathbf{0},
\]</div>
<p>with not all <span class="math notranslate nohighlight">\(\alpha_j\)</span>’s zero. Further, because <span class="math notranslate nohighlight">\(\mathbf{u}_1 \neq \mathbf{0}\)</span>, not all <span class="math notranslate nohighlight">\(\alpha_2, \ldots, \alpha_m\)</span> are zero. (Why? [<em>Hint:</em> There are two cases to consider: <span class="math notranslate nohighlight">\(\alpha_1 = 0\)</span> or <span class="math notranslate nohighlight">\(\alpha_1 \neq 0\)</span>.]) Take the largest index  among the <span class="math notranslate nohighlight">\(\alpha_j\)</span>’s that are non-zero, say <span class="math notranslate nohighlight">\(i\)</span>. Then rearranging the previous display and using the fact that <span class="math notranslate nohighlight">\(\alpha_j=0\)</span> for <span class="math notranslate nohighlight">\(j &gt; i\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
\mathbf{u}_i = - \sum_{j=1}^{i-1} \frac{\alpha_j}{\alpha_i} \mathbf{u}_j \in \mathrm{span}(\mathbf{u}_1,\ldots,\mathbf{u}_{i-1}).
\]</div>
<p>For 2., we note that for any <span class="math notranslate nohighlight">\(\mathbf{w} \in \mathrm{span}(\{\mathbf{u}_j:j \in [m]\})\)</span> we can write it as <span class="math notranslate nohighlight">\(\mathbf{w} = \sum_{j=1}^m \beta_j \mathbf{u}_j\)</span> and we can replace <span class="math notranslate nohighlight">\(\mathbf{u}_i\)</span> by the equation above, producing a representation of <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> in terms of <span class="math notranslate nohighlight">\(\{\mathbf{u}_j:j \in [m], j\neq i\}\)</span>.<span class="math notranslate nohighlight">\(\square\)</span></p>
<p>Before proving the theorem, we use the <em>Linear Dependence Lemma</em> to prove a key claim.</p>
<p><strong>LEMMA</strong> <strong>(Independent is Shorter than Spanning)</strong>  The length of any independent list in <span class="math notranslate nohighlight">\(U\)</span> is less or equal than the length of any spanning list of <span class="math notranslate nohighlight">\(U\)</span>.<span class="math notranslate nohighlight">\(\flat\)</span>
<em>Proof (Independent is Shorter than Spanning):</em> Let <span class="math notranslate nohighlight">\(\{\mathbf{u}_j:j\in[m]\}\)</span> be an independent list in <span class="math notranslate nohighlight">\(U\)</span> and let <span class="math notranslate nohighlight">\(\{\mathbf{w}_i:i\in [m']\}\)</span> be a spanning list of <span class="math notranslate nohighlight">\(U\)</span>. First consider the new list <span class="math notranslate nohighlight">\(\{\mathbf{u}_1,\mathbf{w}_1,\ldots,\mathbf{w}_{m'}\}\)</span>. Because the <span class="math notranslate nohighlight">\(\mathbf{w}_i\)</span>’s are spanning, adding <span class="math notranslate nohighlight">\(\mathbf{u}_1 \neq \mathbf{0}\)</span> to them necessarily produces a linearly dependent list. By the <em>Linear Dependence Lemma</em>, we can remove one of the <span class="math notranslate nohighlight">\(\mathbf{w}_i\)</span>’s without changing the span. The new list <span class="math notranslate nohighlight">\(B\)</span> has length <span class="math notranslate nohighlight">\(m'\)</span> again. Then we add <span class="math notranslate nohighlight">\(\mathbf{u}_2\)</span> to <span class="math notranslate nohighlight">\(B\)</span> immediately after <span class="math notranslate nohighlight">\(\mathbf{u}_1\)</span>. By the <em>Linear Dependence Lemma</em>, one of the vectors in this list is in the span of the previous ones. It cannot be <span class="math notranslate nohighlight">\(\mathbf{u}_2\)</span> as <span class="math notranslate nohighlight">\(\{\mathbf{u}_1, \mathbf{u}_2\}\)</span> are linearly independent by assumption. So it must be one of the remaining <span class="math notranslate nohighlight">\(\mathbf{w}_i\)</span>’s. We remove that one, without changing the span by the <em>Linear Dependence Lemma</em> again. This process can be continued until we have added all the <span class="math notranslate nohighlight">\(\mathbf{u}_j\)</span>’s, as otherwise we would have a contradiction in the argument above. Hence, there must be at least as many <span class="math notranslate nohighlight">\(\mathbf{w}_i\)</span>’s as there are <span class="math notranslate nohighlight">\(\mathbf{u}_j\)</span>’s.<span class="math notranslate nohighlight">\(\square\)</span></p>
<p>We finaly return to the proof of the theorem.</p>
<p><em>Proof (Dimension):</em> Let <span class="math notranslate nohighlight">\(\{\mathbf{b}_j:j\in[m]\}\)</span> and <span class="math notranslate nohighlight">\(\{\mathbf{b}'_j:j\in[m']\}\)</span> be two bases of <span class="math notranslate nohighlight">\(U\)</span>. Because they both form independent and spanning lists, the <em>Independent is Shorter than Spanning Lemma</em> implies that each has a length smaller or equal than the other. So their lenghts must be equal. This proves the claim. <span class="math notranslate nohighlight">\(\square\)</span></p>
<p>We prove a few other useful implications of the <em>Linear Dependence Lemma</em>.</p>
<p><strong>LEMMA</strong> <strong>(Existence of a Spanning List)</strong> There exists a spanning list of <span class="math notranslate nohighlight">\(U\)</span> with a finite number of elements. <span class="math notranslate nohighlight">\(\flat\)</span></p>
<p><em>Proof (Existence of a Spanning List):</em> Start with an empty list. While possible, add nonzero vectors in <span class="math notranslate nohighlight">\(U\)</span> not in the span of the previously added vectors. By the <em>Linear Dependence Lemma</em>, at every step we have constructed an independent list. By the <em>Independent is Shorter than Spanning Lemma</em>, this list cannot be longer than any spanning list of <span class="math notranslate nohighlight">\(V\)</span>. Because <span class="math notranslate nohighlight">\(V\)</span> is spanned by its standard basis, the process must stop after a finite number of steps. <span class="math notranslate nohighlight">\(\square\)</span></p>
<p><strong>LEMMA</strong> <strong>(Completing an Independent List)</strong> Any independent list in <span class="math notranslate nohighlight">\(U\)</span> can be completed into a basis of <span class="math notranslate nohighlight">\(U\)</span>. <span class="math notranslate nohighlight">\(\flat\)</span></p>
<p><em>Proof (Completing an Independent List):</em> Let <span class="math notranslate nohighlight">\(\{\mathbf{u}_j:j\in[\ell]\}\)</span> be an independent list in <span class="math notranslate nohighlight">\(U\)</span>. Let <span class="math notranslate nohighlight">\(\{\mathbf{w}_i : i \in [m]\}\)</span> be a spanning list of <span class="math notranslate nohighlight">\(U\)</span>, which exists by the <em>Existence of a Spanning List Lemma</em>. Add the vectors from the spanning list one by one to the independent list if they are not in the span of the previously constructed list (or discard them otherwise). By the <em>Linear Dependence Lemma</em>, the list remains independent at each step. After <span class="math notranslate nohighlight">\(m\)</span> steps, the resulting list spans all of the <span class="math notranslate nohighlight">\(\mathbf{w}_i\)</span>’s. Hence it spans <span class="math notranslate nohighlight">\(U\)</span> and is linearly independent - that is, it is a basis of <span class="math notranslate nohighlight">\(U\)</span>. <span class="math notranslate nohighlight">\(\square\)</span></p>
</section>
<section id="proof-of-cholesky-decomposition-theorem">
<h2><span class="section-number">2.6.2. </span>Proof of Cholesky decomposition theorem<a class="headerlink" href="#proof-of-cholesky-decomposition-theorem" title="Permalink to this headline">#</a></h2>
<p>In this section, we give a proof of the <em>Cholesky Decomposition Theorem</em>.</p>
<p>We will need a few more properties of positive definite matrices. All three properties follow more or less immediately from the definitions of positive definiteness and linear independence.</p>
<p><strong>LEMMA</strong> <strong>(Invertibility of Positive Definite Matrices)</strong> Let <span class="math notranslate nohighlight">\(B \in \mathbb{R}^{n \times n}\)</span> be positive definite. Then <span class="math notranslate nohighlight">\(B\)</span> is invertible. <span class="math notranslate nohighlight">\(\flat\)</span></p>
<p><em>Proof:</em> For any <span class="math notranslate nohighlight">\(\mathbf{x} \neq \mathbf{0}\)</span>, it holds by positive definiteness that <span class="math notranslate nohighlight">\(\mathbf{x}^T B \mathbf{x} &gt; 0\)</span>. In particular, it must be that <span class="math notranslate nohighlight">\(\mathbf{x}^T B \mathbf{x} \neq 0\)</span> and therefore, by contradiction, <span class="math notranslate nohighlight">\(B \mathbf{x} \neq \mathbf{0}\)</span> (since for any <span class="math notranslate nohighlight">\(\mathbf{z}\)</span>, it holds that <span class="math notranslate nohighlight">\(\mathbf{z}^T \mathbf{0} = 0\)</span>). The claim follows from the <em>Equivalent Definition of Linear Independence</em>. <span class="math notranslate nohighlight">\(\square\)</span></p>
<p>A principal submatrix is a square submatrix obtained by removing certain rows and columns. Moreover we require that the set of row indices that remain is the same as the set of column indices that remain.</p>
<p><strong>LEMMA</strong> <strong>(Principal Submatrices)</strong> Let <span class="math notranslate nohighlight">\(B \in \mathbb{R}^{n \times n}\)</span> be positive definite and let <span class="math notranslate nohighlight">\(Z \in \mathbb{R}^{n \times p}\)</span> have full column rank. Then <span class="math notranslate nohighlight">\(Z^T B Z\)</span> is positive definite. In particular all principal submatrices of positive definite matrices are positive definite. <span class="math notranslate nohighlight">\(\flat\)</span></p>
<p><em>Proof:</em> If <span class="math notranslate nohighlight">\(\mathbf{x} \neq \mathbf{0}\)</span>, then <span class="math notranslate nohighlight">\(\mathbf{x}^T (Z^T B Z) \mathbf{x} = \mathbf{y}^T B \mathbf{y}\)</span>, where we defined <span class="math notranslate nohighlight">\(\mathbf{y} = Z \mathbf{x}\)</span>. Because <span class="math notranslate nohighlight">\(Z\)</span> has full column rank and <span class="math notranslate nohighlight">\(\mathbf{x} \neq \mathbf{0}\)</span>, it follows that <span class="math notranslate nohighlight">\(\mathbf{y} \neq \mathbf{0}\)</span> by the <em>Equivalent Definition of Linear Independence</em>. Hence, since <span class="math notranslate nohighlight">\(B \succ 0\)</span>, we have <span class="math notranslate nohighlight">\(\mathbf{y}^T B \mathbf{y} &gt; 0\)</span> which proves the first claim. For the second claim, take <span class="math notranslate nohighlight">\(Z\)</span> of the form <span class="math notranslate nohighlight">\((\mathbf{e}_{i_1}\ \mathbf{e}_{i_2}\ \ldots\ \mathbf{e}_{i_p})\)</span>, where the indices <span class="math notranslate nohighlight">\(i_1, \ldots, i_p\)</span> are distinct. The columns of <span class="math notranslate nohighlight">\(Z\)</span> are then linearly independent since they are distinct basis vectors. <span class="math notranslate nohighlight">\(\square\)</span></p>
<p><strong>LEMMA</strong> <strong>(Schur Complement)</strong> Let <span class="math notranslate nohighlight">\(B \in \mathbb{R}^{n \times n}\)</span> be positive definite and write it in block form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
B
=
\begin{pmatrix}
B_{11} &amp; B_{12}\\
B_{12}^T &amp; B_{22}
\end{pmatrix}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(B_{11} \in \mathbb{R}^{n_1 \times n_1}\)</span>, <span class="math notranslate nohighlight">\(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\)</span> and <span class="math notranslate nohighlight">\(B_{22} \in \mathbb{R}^{n - n_1 \times n - n_1}\)</span>. Then the Schur complement of the block <span class="math notranslate nohighlight">\(B_{11}\)</span>, i.e., the matrix <span class="math notranslate nohighlight">\(B_{22} - B_{12}^T B_{11}^{-1} B_{12}\)</span>, is positive definite. <span class="math notranslate nohighlight">\(\flat\)</span></p>
<p><em>Proof:</em> By the <em>Principal Submatrices Lemma</em>, <span class="math notranslate nohighlight">\(B_{11}\)</span> is positive definite. By the <em>Invertibility of Positive Definite Matrices Lemma</em>, <span class="math notranslate nohighlight">\(B_{11}\)</span> is therefore invertible. Hence the Schur complement is well defined. The result then follows from the observation (check it!) that, for any <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{x}^T(B_{22} - B_{12}^T B_{11}^{-1} B_{12})\,\mathbf{x}
= 
\mathbf{z}^T
\begin{pmatrix}
B_{11} &amp; B_{12}\\
B_{12}^T &amp; B_{22}
\end{pmatrix}
\mathbf{z}
\quad
\text{where}
\quad
\mathbf{z} =
\begin{pmatrix}
B_{11}^{-1} B_{12} \mathbf{x}\\
- \mathbf{x}
\end{pmatrix}.
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\square\)</span></p>
<p>We return to the proof of the theorem.</p>
<p><em>Proof idea:</em> Assuming by induction that the upper-left corner of the matrix <span class="math notranslate nohighlight">\(B\)</span> has a Cholesky decomposition, one finds equations for the remaining row that can be solved uniquely by the properties established in the previous subsection.</p>
<p><em>Proof:</em> If <span class="math notranslate nohighlight">\(n=1\)</span>, we have shown previously that <span class="math notranslate nohighlight">\(b_{1,1} &gt; 0\)</span>, and hence we can take <span class="math notranslate nohighlight">\(L = [\ell_{1,1}]\)</span> where <span class="math notranslate nohighlight">\(\ell_{1,1} = \sqrt{b_{1,1}}\)</span>. Assuming the result holds for positive definite matrices in <span class="math notranslate nohighlight">\(\mathbb{R}^{(n-1) \times (n-1)}\)</span>, we first re-write <span class="math notranslate nohighlight">\(B = L L^T\)</span> in block form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
B_{11} &amp; \bfbeta_{12}\\
\bfbeta_{12}^T &amp; \beta_{22}
\end{pmatrix}
= 
\begin{pmatrix}
\Lambda_{11} &amp; \mathbf{0}\\
\bflambda_{12}^T &amp; \lambda_{22}
\end{pmatrix}
\begin{pmatrix}
\Lambda_{11}^T &amp; \bflambda_{12}\\
\mathbf{0}^T &amp; \lambda_{22}
\end{pmatrix}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(B_{11}, \Lambda_{11} \in \mathbb{R}^{n-1 \times n-1}\)</span>, <span class="math notranslate nohighlight">\(\bfbeta_{12}, \bflambda_{12} \in \mathbb{R}^{n-1}\)</span> and <span class="math notranslate nohighlight">\(\beta_{22}, \lambda_{22} \in \mathbb{R}\)</span>. By block matrix algebra, we get the system</p>
<div class="math notranslate nohighlight">
\[\begin{split}
B_{11} = \Lambda_{11} \Lambda_{11}^T\\
\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\\
\beta_{22} = \bflambda_{12}^T \bflambda_{12} + \lambda_{22}^2.
\end{split}\]</div>
<p>By the <em>Principal Submatrices Lemma</em>, the principal submatrix <span class="math notranslate nohighlight">\(B_{11}\)</span> is positive definite. Hence, by induction, there is a unique lower-triangular matrix <span class="math notranslate nohighlight">\(\Lambda_{11}\)</span> with positive diagonal elements satisfying the first equation. We can then obtain <span class="math notranslate nohighlight">\(\bfbeta_{12}\)</span> from the second equation by forward substitution. And finally we get</p>
<div class="math notranslate nohighlight">
\[
\lambda_{22}
= \sqrt{\beta_{22} - \bflambda_{12}^T \bflambda_{12}}.
\]</div>
<p>We do have to check that the square root above exists. That is, we need to argue that the expression inside the square root is non-negative. In fact, for the claim to go through, we need it to be strictly positive. We notice that the expression inside the square root is in fact the Schur complement of the block <span class="math notranslate nohighlight">\(B_{11}\)</span>:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\beta_{22} - \bflambda_{12}^T \bflambda_{12}
&amp;= \beta_{22} - (\Lambda_{11}^{-1} \bfbeta_{12})^T (\Lambda_{11}^{-1} \bfbeta_{12})\\
&amp;= \beta_{22} - \bfbeta_{12}^T (\Lambda_{11}^{-1})^T \Lambda_{11}^{-1} \bfbeta_{12}\\
&amp;= \beta_{22} - \bfbeta_{12}^T (\Lambda_{11} \Lambda_{11}^T)^{-1} \bfbeta_{12}\\
&amp;= \beta_{22} - \bfbeta_{12}^T (B_{11})^{-1} \bfbeta_{12}
\end{align*}\]</div>
<p>where we used the equation <span class="math notranslate nohighlight">\(\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\)</span> on the first line, the identities <span class="math notranslate nohighlight">\((Q W)^{-1} = W^{-1} Q^{-1}\)</span> and <span class="math notranslate nohighlight">\((Q^T)^{-1} = (Q^{-1})^T\)</span> (see the exercise below) on the third line and the equation <span class="math notranslate nohighlight">\(B_{11} = \Lambda_{11} \Lambda_{11}^T\)</span> on the fourth line. By the <em>Schur Complement Lemma</em>, the Schur complement is positive definite. Because it is a scalar in this case, it is strictly positive (see <em>Exercise 2.14</em>), which concludes the proof. <span class="math notranslate nohighlight">\(\square\)</span></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chap02_ls/06_adv"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../05_qr/roch-mmids-ls-5qr.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.5. </span>QR decomposition and Householder transformations</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-dependence-lemma-and-its-implications">2.6.1. Linear Dependence Lemma and its implications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-cholesky-decomposition-theorem">2.6.2. Proof of Cholesky decomposition theorem</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sebastien Roch
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>